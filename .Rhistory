knitr::opts_chunk$set(echo = TRUE)
# CSV data file path:
path <- "C:/Users/mogde/Desktop/Git Repositories/CSC365/CSC365RealFinalProject/book32-listing-small.csv"
# TXT file to be written to:
out_path <- "C:/Users/mogde/Desktop/Git Repositories/CSC365/CSC365RealFinalProject/BookInsertStatements.sql"
library(tidyverse)
my.data <- read.csv(path, header=FALSE)
names(my.data) <- c("id_num", "title", "author", "num_copies", "category")
summary(my.data$num_copies)
out_file <- file(
description = out_path,
open="wt")
beginning <- "INSERT INTO Book (copyNum, title, author, numCopies, category) VALUES (\""
for (i in 1:nrow(my.data)) {
title <- my.data[i, "title"]
author <- my.data[i, "author"]
num_copies <- as.integer(my.data[i, "num_copies"])
category <- my.data[i, "category"]
for (j in 1:num_copies) {
line <- str_c(beginning, j, title, "\", \"", author, "\", ", num_copies, ", \"", category, "\");")
writeLines(line, out_file)
}
}
close(out_file, type="wt")
out_file <- file(
description = out_path,
open="wt")
beginning <- "INSERT INTO Book (copyNum, title, author, numCopies, category) VALUES ("
for (i in 1:nrow(my.data)) {
title <- my.data[i, "title"]
author <- my.data[i, "author"]
num_copies <- as.integer(my.data[i, "num_copies"])
category <- my.data[i, "category"]
for (j in 1:num_copies) {
line <- str_c(beginning, j,", \"", title, "\", \"", author, "\", ", num_copies, ", \"", category, "\");")
writeLines(line, out_file)
}
}
close(out_file, type="wt")
